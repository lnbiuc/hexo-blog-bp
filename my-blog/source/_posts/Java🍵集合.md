---
title: JavağŸµé›†åˆ
date: 2022/7/15 12:20:37
updated: 2023/3/23 23:01:34
categories:
- Java
tags:
- Java
- Collection
---

# Javaé›†åˆ

## Javaé›†åˆæ¡†æ¶

![image](https://user-pic-1308549476.cos.ap-nanjing.myqcloud.com/pic/99111661686225193.png)

##  æ¦‚è¿°
> Collectionå’ŒMapå¯ä»¥ç†è§£ä¸ºå­˜æ”¾å†…å®¹çš„å®¹å™¨ï¼Œæœ‰ä¸¤å¤§æ¥å£æ´¾ç”Ÿè€Œæ¥ï¼Œä¸€ä¸ªæ˜¯`Collection`ï¼Œå¦ä¸€ä¸ªæ˜¯`Map`ï¼Œåœ¨`Collection`æ¥å£ä¸‹ï¼Œåˆåˆ†åˆ«æœ‰ä¸‰ä¸ªå­æ¥å£ï¼Œåˆ†åˆ«æ˜¯`List`ã€`Set`ã€`Queue`ã€‚
> ç›¸åŒçš„æ˜¯Collectionéƒ½åªèƒ½ç”¨æ¥å­˜å‚¨å¯¹è±¡ï¼Œå¯¹äºåŸºæœ¬æ•°æ®ç±»å‹(int, long, float, doubleç­‰)ï¼Œéœ€è¦å°†å…¶è½¬åŒ–ä¸ºåŒ…è£…ç±»å‹ï¼Œè¿™äº›è£…ç®±æ“ä½œèƒ½è‡ªåŠ¨å®Œæˆï¼Œä½†æ˜¯ä¼šä½¿ç”¨é¢å¤–çš„æ€§èƒ½å’Œç©ºé—´ã€‚
> ä¸åŒçš„æ˜¯Collectionåªèƒ½ç”¨æ¥å­˜æ”¾å•ä¾‹å¯¹è±¡ï¼Œè€ŒMapåªèƒ½å­˜æ”¾åŒä¾‹å¯¹è±¡
---
> Q1ï¼šListï¼ŒSetï¼ŒQueueï¼ŒMapå››è€…çš„åŒºåˆ«ï¼Ÿ


- `List`å­˜å‚¨å…ƒç´ æ˜¯æœ‰åºçš„ï¼Œå¯é‡å¤çš„ã€‚
- `Set`å­˜å‚¨å…ƒç´ æ˜¯æ— åºçš„ï¼Œä¸å¯é‡å¤çš„ã€‚
- `Queue`æŒ‰ç…§é˜Ÿåˆ—è§„åˆ™ç¡®å®šå…ˆåé¡ºåºï¼Œæ˜¯æœ‰åºçš„ï¼Œå¯é‡å¤çš„ã€‚
- `Map`ä½¿ç”¨key-valueçš„é”®å€¼å¯¹å­˜å‚¨å…ƒç´ ï¼Œå…¶ä¸­keyæ˜¯æ— åºçš„ï¼Œä¸å¯é‡å¤çš„ï¼Œvalueæ˜¯æ— åºï¼Œå¯é‡å¤çš„ï¼Œä¸”æ¯ä¸ªkeyåªèƒ½å¯¹åº”ä¸€ä¸ªvalueã€‚
### List
- `ArrayList<Object[]>`
- `Vector<Object[]>`
- `LinkedList<Object>`
---
> Q2ï¼šArrayListå’ŒVectorçš„åŒºåˆ«ï¼Ÿ

-  `ArrayList`æ˜¯`List`çš„ä¸»è¦å®ç°ç±»ï¼Œåº•å±‚ä½¿ç”¨`Object[]`å­˜å‚¨ï¼Œé€‚ç”¨äºéœ€è¦é¢‘ç¹æŸ¥æ‰¾çš„å·¥ä½œï¼Œçº¿ç¨‹ä¸å®‰å…¨ã€‚
- `Vector`æ˜¯`List`å¤è€å®ç°ç±»ï¼ŒåŒ…å«å¾ˆå¤šä¸å±äºé›†åˆæ¡†æ¶çš„ä¼ ç»Ÿæ–¹æ³•ï¼Œåº•å±‚ä½¿ç”¨`Object[]`å­˜å‚¨ï¼ŒåŒæ­¥è®¿é—®ï¼Œçº¿ç¨‹å®‰å…¨ã€‚

> Q3ï¼šArrayListå’ŒLinkedListçš„åŒºåˆ«ï¼Ÿ

- **æ˜¯å¦çº¿ç¨‹å®‰å…¨**ï¼šéƒ½ä¸çº¿ç¨‹å®‰å…¨
- **åº•å±‚æ•°æ®ç»“æ„**ï¼š`ArrayList`åº•å±‚ä½¿ç”¨Objectæ•°ç»„ã€‚
`LinkedList`åœ¨JDK1.6ä»¥å‰ä½¿ç”¨å¾ªç¯é“¾è¡¨ï¼ŒJDK1.7ä½¿ç”¨é“¾è¡¨
- **æ˜¯å¦æ”¯æŒéšæœºè®¿é—®**ï¼šå³æ˜¯å¦ç›´æ¥`get(int index)`,`ArrayList`æ”¯æŒï¼Œ`LinkedList`ä¸æ”¯æŒ
- **ç©ºé—´å ç”¨æƒ…å†µ**ï¼š`ArrayList`å ç”¨å¤šä½™ç©ºé—´åœ¨äº`ArrayList`è‡ªåŠ¨æ‰©å®¹çš„æ€§è´¨ã€‚
`LinkedList`å ç”¨ç©ºé—´åœ¨äºéœ€è¦é¢å¤–å­˜å‚¨å‰é©±ä»¥åŠåç»§
> ä¼˜å…ˆä½¿ç”¨`ArrayList`

### Set
- `HashSet<Object>`
- `LinkedHashSet<Object>`
- `TreeSet<Object>`
---

> Q4: HashSetã€LinkedHashSetã€TreeSet ä¸‰è€…åŒºåˆ«
- ä¸‰è€…éƒ½å®ç°äº†Setæ¥å£ï¼Œéƒ½èƒ½ä¿è¯å…ƒç´ çš„å”¯ä¸€ï¼Œä½†æ˜¯éƒ½ä¸æ—¶çº¿ç¨‹å®‰å…¨çš„
- ä¸‰è€…ä¸»è¦åŒºåˆ«åœ¨äºåº•å±‚æ•°æ®ç»“æ„ä¸åŒ
    - `HashSet`åº•å±‚æ•°æ®ç»“æ„æ—¶å“ˆå¸Œè¡¨ï¼ŒåŸºäºHashMapå®ç°
    - `LinkedHashSet`åº•å±‚æ—¶é“¾è¡¨å’Œå“ˆå¸Œè¡¨ï¼Œå…ƒç´ æ’å…¥äºå–å‡ºé¡ºåºå…ˆå…¥å…ˆå‡º
    - `TreeSet`åº•å±‚ä¹¦çº¢é»‘æ ‘ï¼Œå…ƒç´ æ˜¯æœ‰åºçš„
- ç”±äºåº•å±‚æ•°æ®ç»“æ„çš„ä¸åŒï¼Œå¯¼è‡´ä¸‰è€…é€‚ç”¨åœºæ™¯ä¸åŒ
    - `HashSet`é€‚ç”¨äºä¸éœ€è¦ä¿è¯å…ƒç´ æ’å…¥å’Œå–å‡ºé¡ºåºçš„åœºæ™¯
    - `LinkedHashSet`é€‚ç”¨äºå…ƒç´ æ’å…¥å–å‡ºé¡ºåºæ»¡è¶³å…ˆå…¥å…ˆå‡ºç‰¹æ€§çš„åœºæ™¯
    - `TreeSet`é€‚ç”¨äºéœ€è¦æ”¯æŒå…ƒç´ è‡ªå®šä¹‰æ’åºè§„åˆ™çš„åœºæ™¯
>  Q5ï¼šæ— åºæ€§
- æ— åºæ€§æ˜¯æŒ‡å­˜å‚¨çš„æ•°æ®åœ¨åº•å±‚æ•°ç»„ä¸­ä¸æŒ‰æ•°ç»„çš„ç´¢å¼•é¡ºåºæ·»åŠ ï¼Œè€Œæ˜¯æ ¹æ®æ•°æ®çš„å“ˆå¸Œå€¼æ·»åŠ 

---
###  Queue
- `PriorityQeue<Object>`
- `ArrayQeue<Object>`
> Q6ï¼šQueue ä¸ Deque çš„åŒºåˆ«
- `Queue`æ˜¯å•å‘é˜Ÿåˆ—ï¼Œåªèƒ½ä»ä¸€ç«¯æ’å…¥å…ƒç´ ï¼Œå¦ä¸€ç«¯åˆ é™¤å…ƒç´ ï¼Œéµå¾ªå…ˆå…¥å…ˆå‡ºåŸåˆ™
- `Deque`æ˜¯åŒå‘é˜Ÿåˆ—ï¼Œåœ¨é˜Ÿåˆ—ä¸¤ç«¯éƒ½å¯æ’å…¥åˆ é™¤å…ƒç´ ï¼Œä»ç„¶éµå¾ªå…ˆå…¥å…ˆå‡ºåŸåˆ™

> Q7ï¼šArrayDeque ä¸ LinkedList çš„åŒºåˆ«
- ä¸¤è€…éƒ½å®ç°äº†Dequeæ¥å£ï¼Œéƒ½å…·æœ‰é˜Ÿåˆ—çš„åŠŸèƒ½
- **æ•°æ®ç»“æ„ä¸åŒ**ï¼š
     - `ArrayDeque`åŸºäºå¯å˜é•¿çš„æ•°ç»„å’ŒåŒå‘æŒ‡é’ˆå®ç°
     - `LinkedList`åŸºäºé“¾è¡¨å®ç°
- **æ€§èƒ½**ï¼š
    - `ArrayDeque`æ’å…¥æ—¶å¯èƒ½å‡ºç°æ‰©å®¹ï¼Œä½†æ˜¯å¤æ‚åº¦ä¸ºO(1)
    - `LinkedList`ä¸éœ€è¦æ‰©å®¹ï¼Œä½†æ˜¯æ¯æ¬¡æ’å…¥æ•°æ®éƒ½éœ€è¦ç”³è¯·æ–°çš„å †ç©ºé—´
    `ArrayDeque`æ‹¥æœ‰æ›´å¥½çš„æ€§èƒ½
- `ArrayDeque` å¯ç”¨äºå®ç°æ ˆ
---
### Map
- `HashMap<K,V>`
- `LinkedHashMap<K,V>`
- `HashTable<K,V>`
- `TreeMap<K,V>`

> Q8ï¼šHashMap å’Œ Hashtable çš„åŒºåˆ«


> 1. ArrayListå®ç°äº†Listæ¥å£ï¼Œæ˜¯é¡ºåºå®¹å™¨ï¼Œåº•å±‚é€šè¿‡æ•°ç»„å®ç°ã€‚
>
> 2. å½“ä½¿ç”¨add()æ–¹æ³•æ˜¯ï¼Œä¸ºäº†å¢åŠ æ•ˆç‡ï¼Œæœªå®ç°åŒæ­¥(synchronized)ï¼Œå¦‚æœéœ€è¦å¤šçº¿ç¨‹å¹¶å‘è®¿é—®ï¼Œåº”è¯¥ä½¿ç”¨Vector
> 3. HashMapå¯ä»¥å­˜å‚¨null valueå’Œnull keyï¼ŒHashTableä¸å…è®¸å‡ºç°null value å’Œ null keyï¼Œä¼šæŠ›å‡ºå¼‚å¸¸`NullPointerException`
> 4. åˆå§‹å®¹é‡å¤§å°å’Œæ‰©å……å®¹é‡å¤§å°çš„åŒºåˆ«
>     1. åˆ›å»ºæ—¶æœªæŒ‡å®šå®¹é‡ï¼ŒHashTableé»˜è®¤ä¸º11ï¼Œæ¯æ¬¡æ‰©å……ä¸º2n+1ã€‚HashMapé»˜è®¤ä¸º16ï¼Œæ¯æ¬¡æ‰©å®¹ä¸º2n
>     2. åˆ›å»ºæ—¶æŒ‡å®šäº†åˆå§‹å®¹é‡ï¼ŒHashTableä¼šä½¿ç”¨ä½ æŒ‡å®šçš„å¤§å°ï¼ŒHashMapä¼šæ‰©å®¹2çš„å¹‚æ¬¡æ–¹å¤§å°
>     3. åº•å±‚æ•°æ®ç»“æ„ï¼šHashMapåœ¨å½“é“¾è¡¨é•¿åº¦å¤§äºé˜ˆå€¼8ä¹‹åï¼Œä¼šå°†é“¾è¡¨è½¬ä¸ºçº¢é»‘æ ‘ï¼Œä»¥è¾ƒå°‘ç´¢å¼•æ—¶é—´
# æ•°æ®ç»“æ„

> [äºŒå‰æœç´¢æ ‘ç®—æ³•å¯è§†åŒ–](https://visualgo.net/zh/bst)
>
> [äºŒå‰æœç´¢æ ‘ç›¸å…³ç®—æ³•ä»‹ç»](https://www.cnblogs.com/MrListening/p/5782752.html)

## äºŒå‰æœç´¢æ ‘

> äºŒå‰æœç´¢æ ‘ï¼ˆåˆï¼šäºŒå‰æŸ¥æ‰¾æ ‘ï¼ŒäºŒå‰æ’åºæ ‘ï¼ŒBinary Search Treeï¼ŒBSTï¼‰æ˜¯ä¸€ç§äºŒå‰æ ‘ã€‚
>
> å…¶ä¸­æ¯ä¸ªç»“ç‚¹æœ€å¤šæœ‰ä¸¤ä¸ªå­ç»“ç‚¹ä¸”å…·æœ‰äºŒå‰æœç´¢æ ‘æ€§è´¨ã€‚
>
> å·¦å­æ ‘ä¸Šæ‰€æœ‰ç»“ç‚¹çš„å€¼å‡å°äºå®ƒçš„æ ¹ç»“ç‚¹çš„å€¼ã€‚
>
> å³å­æ ‘ä¸Šæ‰€æœ‰ç»“ç‚¹çš„å€¼å‡å¤§äºå®ƒçš„æ ¹ç»“ç‚¹çš„å€¼ã€‚

ä¸ªäººå¯¹äºäºŒå‰æœç´¢æ ‘çš„ç†è§£ï¼Œä¾‹å¦‚ï¼šä¸‹å›¾æ˜¯ä¸€ä¸ªäºŒå‰æœç´¢æ ‘

1. å¦‚æœè¦ç”¨ç»„æ•°æ„å»ºå¹³è¡¡äºŒå‰æ ‘ï¼Œé¦–å…ˆå°†è¿™ç»„æ•°æ’åºã€‚
2. é€‰å‡ºä¸­ä½æ•°ä¸ºæ ¹èŠ‚ç‚¹ï¼Œå¤§äºæ ¹èŠ‚ç‚¹çš„æ•°æ”¾åœ¨å³è¾¹ï¼Œå°äºæ ¹èŠ‚ç‚¹çš„æ•°æ”¾åœ¨å·¦è¾¹ã€‚
3. ä¹‹ååœ¨å°äºæ ¹èŠ‚ç‚¹éƒ¨åˆ†ç»§ç»­é€‰å‡ºä¸­ä½æ•°ï¼Œä¸ºä¸Šä¸ªæ ¹èŠ‚ç‚¹çš„å·¦å­©å­ã€‚å¤§äºæ ¹èŠ‚ç‚¹éƒ¨åˆ†é€‰å‡ºä¸­ä½æ•°ï¼Œä¸ºæ ¹èŠ‚ç‚¹å³å­©å­ã€‚
4. ç»§ç»­é€‰å–ä¸­ä½æ•°ï¼Œæ„å»ºå®Œæ•´äºŒå‰æœç´¢æ ‘ã€‚

![image-20220909170628143](https://typora-1308549476.cos.ap-nanjing.myqcloud.com/img/image-20220909170628143.png)

> äºŒå‰æœç´¢æ ‘çš„æ’å…¥ï¼ŒæŸ¥æ‰¾æ—¶é—´å¤æ‚åº¦ä½ä¸ºO(log n)

### æŸ¥æ‰¾

> åœ¨äºŒå‰æ ‘bä¸­æŸ¥æ‰¾xçš„è¿‡ç¨‹
>
> 1. å¦‚æœbæ ‘ == nullï¼ŒæŸ¥è¯¢å¤±è´¥
> 2. å¦‚æœxç­‰äºbçš„æ ¹èŠ‚ç‚¹æ•°ï¼Œåˆ™æŸ¥æ‰¾æˆåŠŸï¼Œå¦åˆ™ï¼š
> 3. å¦‚æœxå°äºbçš„æ ¹èŠ‚ç‚¹æ•°ï¼Œåˆ™æœç´¢å·¦å­æ ‘ï¼Œå¦åˆ™
> 4. æŸ¥æ‰¾å³å­æ ‘

**ä¾‹å¦‚ï¼šæŸ¥æ‰¾x = 77çš„è¿‡ç¨‹**

1. x = 77ï¼Œx > 41 æŸ¥æ‰¾å³å­æ ‘
2. å³å­æ ‘æ ¹èŠ‚ç‚¹65ï¼Œx > 65ï¼ŒæŸ¥æ‰¾å³å­æ ‘
3. å³å­æ ‘æ ¹èŠ‚ç‚¹91ï¼Œx < 91ï¼ŒæŸ¥æ‰¾å·¦å­æ ‘

![image-20220909171820326](https://typora-1308549476.cos.ap-nanjing.myqcloud.com/img/image-20220909171820326.png)

![image-20220921210426744](https://typora-1308549476.cos.ap-nanjing.myqcloud.com/img/image-20220921210426744.png)

### æ’å…¥

> ä¸èƒ½æ’å…¥é‡å¤èŠ‚ç‚¹
>
> 1. è‹¥bæ˜¯ç©ºæ ‘ï¼Œå°†xä½œä¸ºæ ¹èŠ‚ç‚¹æ’å…¥
> 2. x ç­‰äºbæ ¹èŠ‚ç‚¹ï¼Œæ’å…¥æˆåŠŸï¼Œå¦åˆ™
> 3. x å°äºbæ ¹èŠ‚ç‚¹ï¼Œxæ’å…¥åˆ°å·¦å­æ ‘ï¼Œå¦åˆ™
> 4. x æ’å…¥åˆ°å³å­æ ‘ä¸­ã€‚ï¼ˆæ–°æ’å…¥èŠ‚ç‚¹æ€»æ˜¯å¶å­èŠ‚ç‚¹ï¼‰

ä¾‹å¦‚ï¼šæ’å…¥x = 27

![image-20220909172718987](https://typora-1308549476.cos.ap-nanjing.myqcloud.com/img/image-20220909172718987.png)

### åˆ é™¤

åˆ é™¤çš„4ç§æƒ…å†µ

1. è¦åˆ é™¤çš„èŠ‚ç‚¹æ— å·¦å³å­©å­

    - å½’ä¸º234æƒ…å†µä¸­ä¸€ç§

2. åªæœ‰å·¦å­©å­

    - è®©è¯¥èŠ‚ç‚¹çš„çˆ¶äº²ç»“ç‚¹æŒ‡å‘è¯¥èŠ‚ç‚¹çš„å·¦å­©å­ï¼Œç„¶ååˆ é™¤è¯¥èŠ‚ç‚¹

    ![image-20220909173759162](https://typora-1308549476.cos.ap-nanjing.myqcloud.com/img/image-20220909173759162-20220909173918255.png)

3. åªæœ‰å³å­©å­

    - è®©è¯¥èŠ‚ç‚¹çš„çˆ¶äº²ç»“ç‚¹æŒ‡å‘è¯¥èŠ‚ç‚¹çš„å³å­©å­ï¼Œç„¶ååˆ é™¤è¯¥èŠ‚ç‚¹

    ![image-20220909173821209](https://typora-1308549476.cos.ap-nanjing.myqcloud.com/img/image-20220909173821209.png)

4. æœ‰å·¦å³å­©å­

    1. æ‰¾åˆ°è¯¥èŠ‚ç‚¹çš„å³å­æ ‘ä¸­çš„æœ€å·¦å­©å­ï¼ˆä¹Ÿå°±æ˜¯å³å­æ ‘ä¸­åºéå†çš„ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ï¼‰
    2. æŠŠå®ƒçš„å€¼å’Œè¦åˆ é™¤çš„èŠ‚ç‚¹çš„å€¼è¿›è¡Œäº¤æ¢
    3. æŒ‰ç…§ä¹‹å‰çš„æ–¹æ³•åˆ é™¤è¯¥èŠ‚ç‚¹

    ![image-20220909173857000](https://typora-1308549476.cos.ap-nanjing.myqcloud.com/img/image-20220909173857000.png)

## å¹³è¡¡äºŒå‰æ ‘

> [åŸæ–‡è¿æ¥](https://zhuanlan.zhihu.com/p/56066942)

> å¹³è¡¡äºŒå‰æŸ¥æ‰¾æ ‘ï¼Œç®€ç§°å¹³è¡¡äºŒå‰æ ‘ï¼Œåˆç§°AVLæ ‘
>
> å¹³è¡¡äºŒå‰æ ‘å¯èƒ½æ˜¯ç©ºæ ‘ã€‚
>
> å¦‚æœä¸æ˜¯ç©ºæ ‘ï¼Œä»»ä½•ä¸€ä¸ªç»“ç‚¹çš„å·¦å­æ ‘ä¸å³å­æ ‘éƒ½æ˜¯å¹³è¡¡äºŒå‰æ ‘ï¼Œå¹¶ä¸”é«˜åº¦ä¹‹å·®ä¸è¶…è¿‡ 1ã€‚

### å¹³è¡¡å› å­

> æŸèŠ‚ç‚¹å·¦å­æ ‘å³å­æ ‘é«˜åº¦å·®ä¸ºè¯¥èŠ‚ç‚¹çš„å¹³è¡¡å› å­

> å¹³è¡¡äºŒå‰æ ‘ä¸­ä¸å­˜åœ¨é«˜åº¦å·®å¤§äº1çš„èŠ‚ç‚¹

ä¸ªäººå¯¹äºå¹³è¡¡äºŒå‰æ ‘çš„ç†è§£ï¼šåœ¨äºŒå‰æœç´¢æ ‘çš„åŸºç¡€ä¸Šï¼Œé€šè¿‡è°ƒæ•´æ ‘çš„ç»“æ„ï¼ˆå·¦æ—‹ï¼Œå³æ—‹ï¼‰ï¼Œæ¥ä½¿äºŒå‰æ ‘é™ä½é«˜åº¦ï¼Œä¿æŒå¹³è¡¡ã€‚ä¸ºäº†ä¿æŒå¹³è¡¡ï¼Œå¹³è¡¡äºŒå‰æ ‘éœ€è¦ä¸¥æ ¼éµå®ˆæ€§è´¨3ï¼Œå·¦å­æ ‘ä¸å³å­æ ‘é«˜åº¦å·®ä¸è¶…è¿‡1ã€‚è¿™å¯¼è‡´äº†æ·»åŠ å’Œåˆ é™¤èŠ‚ç‚¹å¾ˆå®¹æ˜“å¼•èµ·æ ‘çš„ä¸å¹³è¡¡ï¼Œéœ€è¦æ¶ˆè€—èµ„æºæ¥ä½¿æ ‘é‡æ–°è¾¾åˆ°å¹³è¡¡çŠ¶æ€ã€‚è¿™äº›èµ„æºæ¶ˆè€—å¤§ï¼Œå¸¦æ¥çš„æ”¶ç›Šå´æœ‰é™ï¼Œæ‰€ä»¥äº§ç”Ÿäº†çº¢é»‘æ ‘ã€‚

### AVLæ ‘æ’å…¥

çœ‹åŸæ–‡

å¦‚æœæ’å…¥ä¹‹åæŸä¸ªèŠ‚ç‚¹çš„å¹³è¡¡å› å­å¤§äº1æˆ–è€…å°äº-1ï¼Œåˆ™éœ€è¦é€šè¿‡æ—‹è½¬**æœ€å°å¤±è¡¡å­æ ‘**æ¥ä¿æŒæ ‘çš„å¹³è¡¡ã€‚

> **æœ€å°å¤±è¡¡å­æ ‘**ï¼šåœ¨æ–°æ’å…¥çš„èŠ‚ç‚¹å‘ä¸ŠæŸ¥æ‰¾ï¼Œä»¥ç¬¬ä¸€ä¸ªå¹³è¡¡å› å­çš„ç»å¯¹å€¼è¶…è¿‡1çš„èŠ‚ç‚¹ä¸ºæ ¹çš„å­æ ‘ï¼Œæˆä¸ºæœ€å°ä¸å¹³è¡¡å­æ ‘ã€‚
>
> ä¾‹å¦‚ï¼š
>
> ![image-20220914153626091](https://typora-1308549476.cos.ap-nanjing.myqcloud.com/img/image-20220914153626091.png)
> æ­¤å›¾ä¸­ï¼Œ99ä¸ºæ–°æ’å…¥çš„èŠ‚ç‚¹ï¼Œ66çš„å³å­æ ‘ä¸ºæœ€å°å¤±è¡¡å­æ ‘ã€‚

### å·¦æ—‹

1. èŠ‚ç‚¹ï¼ˆç¬¬ä¸€ä¸ªå¹³è¡¡å› å­ç»å¯¹å€¼è¶…è¿‡1çš„èŠ‚ç‚¹ï¼‰çš„å³å­©å­æ›¿ä»£æ­¤èŠ‚ç‚¹çš„ä½ç½®
2. å³å­©å­çš„å·¦å­æ ‘å˜ä¸ºè¯¥èŠ‚ç‚¹çš„å³å­æ ‘
3. èŠ‚ç‚¹æœ¬èº«å˜æˆå³å­©å­çš„å·¦å­æ ‘

![image-20220914154035495](https://typora-1308549476.cos.ap-nanjing.myqcloud.com/img/image-20220914154035495.png)

### å³æ—‹

1. èŠ‚ç‚¹çš„å·¦å­©å­ä»£æ›¿æ­¤èŠ‚ç‚¹
2. èŠ‚ç‚¹çš„å·¦å­©å­çš„å³å­æ ‘è¾¹å”±èŠ‚ç‚¹çš„å·¦å­æ ‘
3. å°†æ­¤èŠ‚ç‚¹ä½œä¸ºå·¦å­©å­çš„å³å­æ ‘

## çº¢é»‘æ ‘

> [åŸæ–‡è¿æ¥](https://www.jianshu.com/p/e136ec79235c)

### å®šä¹‰åŠæ€§è´¨

çº¢é»‘æ ‘æ˜¯ä¸€ç§å«æœ‰çº¢é»‘èŠ‚ç‚¹ï¼Œå¹¶ä¸”èƒ½è‡ªå¹³è¡¡çš„äºŒå‰æœç´¢æ ‘ã€‚

æ»¡è¶³ä»¥ä¸‹æ€§è´¨ï¼š

1. æ¯ä¸ªèŠ‚ç‚¹åªèƒ½æ˜¯é»‘è‰²æˆ–è€…çº¢è‰²
2. æ ¹èŠ‚ç‚¹æ˜¯é»‘è‰²
3. å¶å­èŠ‚ç‚¹æ˜¯é»‘è‰²
4. æ¯ä¸ªçº¢è‰²èŠ‚ç‚¹çš„ä¸¤ä¸ªå­èŠ‚ç‚¹ä¸€å®šæ˜¯é»‘è‰²
5. **ä»»æ„ä¸€èŠ‚ç‚¹åˆ°æ¯ä¸ªå¶å­èŠ‚ç‚¹çš„è·¯å¾„éƒ½åŒ…å«æ•°é‡ç›¸åŒçš„é»‘èŠ‚ç‚¹**

çº¢é»‘æ ‘åœ¨æ’å…¥æˆ–è€…åˆ é™¤æ—¶ï¼Œæ ‘çš„ç»“æ„ä¼šå‘ç”Ÿæ”¹å˜ï¼Œå¯¼è‡´æ¡ä»¶4ã€5ä¸æˆç«‹ï¼Œéœ€è¦é€šè¿‡æ—‹è½¬æ¥ä½¿å…¶é‡æ–°æ»¡è¶³çº¢é»‘æ ‘çš„æ¡ä»¶

ä¸ªäººå¯¹äºçº¢é»‘æ ‘çš„ç†è§£ï¼šçº¢é»‘æ ‘æ˜¯ä¸€ç§å¼±å¹³è¡¡äºŒå‰æ ‘ï¼Œç”±äºå¹³è¡¡äºŒå‰æ ‘å¯¹äºå¹³è¡¡çš„ä¸¥æ ¼é™åˆ¶ï¼Œå¯¼è‡´éœ€è¦é¢‘ç¹æ—‹è½¬æ ‘æ¥è¾¾åˆ°å¹³è¡¡ï¼Œçº¢é»‘æ ‘æ”¾å®½äº†è¿™ä¸€é™åˆ¶ï¼Œä½¿å¾—åœ¨éœ€è¦é¢‘ç¹æ’å…¥åˆ é™¤èŠ‚ç‚¹çš„æƒ…å†µä¸‹ï¼Œçº¢é»‘æ ‘ä¼˜äºå¹³è¡¡äºŒå‰æ ‘ã€‚åŒæ—¶çº¢é»‘æ ‘ç»™æ¯ä¸ªèŠ‚ç‚¹éƒ½æ ‡è®°äº†é¢œè‰²ï¼Œä½¿çº¢é»‘æ ‘æœ‰ä¸‰ç§æ–¹å¼æ¥ä¿æŒå¹³è¡¡ï¼Œå·¦æ—‹ã€å³æ—‹ã€å˜è‰²ã€‚

çº¢é»‘æ ‘é€šè¿‡å·¦æ—‹ã€å³æ—‹ã€å˜è‰²æ¥ä¿æŒå¹³è¡¡ï¼š

- å·¦æ—‹ï¼šå³å­ç»“ç‚¹å˜ä¸ºæ—‹è½¬ç»“ç‚¹çš„çˆ¶ç»“ç‚¹ï¼Œå³å­ç»“ç‚¹çš„å·¦å­ç»“ç‚¹å˜ä¸ºæ—‹è½¬ç»“ç‚¹çš„å³å­ç»“ç‚¹ï¼Œå·¦å­ç»“ç‚¹ä¿æŒä¸å˜ã€‚
- å³æ—‹ï¼šå·¦å­ç»“ç‚¹å˜ä¸ºæ—‹è½¬ç»“ç‚¹çš„çˆ¶ç»“ç‚¹ï¼Œå·¦å­ç»“ç‚¹çš„å³å­ç»“ç‚¹å˜ä¸ºæ—‹è½¬ç»“ç‚¹çš„å·¦å­ç»“ç‚¹ï¼Œå³å­ç»“ç‚¹ä¿æŒä¸å˜ã€‚
- å˜è‰²ï¼šèŠ‚ç‚¹çš„é¢œè‰²ç”±çº¢å˜é»‘æˆ–ç”±é»‘å˜çº¢

### æŸ¥æ‰¾

åŒäºŒå‰æ ‘çš„æŸ¥æ‰¾æ–¹å¼ã€‚

# æºç 

## ArrayList
### è‡ªåŠ¨æ‰©å®¹æœºåˆ¶

- æ¯å½“å‘ArrayListä¸­æ·»åŠ å…ƒç´ æ—¶ï¼Œä¼šå…ˆåˆ¤æ–­æ’å…¥ä¹‹åçš„sizeæ˜¯å¦ä¼šå¤§äºå½“å‰çš„sizeï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è¿›è¡Œæ‰©å®¹ã€‚

- æ‰©å®¹é€šè¿‡æ–¹æ³•`ensureCapacity(int minCapacity)`å®ç°

- å½“åˆå§‹åŒ–ä¸€ä¸ªArrayListï¼Œä¸”æ²¡æœ‰æŒ‡å®šcapacityæ—¶ï¼Œè¯¥æ•°ç»„çš„é•¿åº¦æ˜¯0ã€‚

- å½“ç¬¬ä¸€æ¬¡å‘ArrayListä¸­æ·»åŠ å…ƒç´ æ—¶ï¼Œæ•°ç»„ä¼šæ‰©å®¹capacityåˆ°10ã€‚

- å½“æ·»åŠ ç¬¬10ä¸ªå…ƒç´ æ—¶ï¼Œæ­¤æ—¶çš„å®¹é‡ä»ä¸º10ï¼Œä¸ä¼šè¿›è¡Œæ‰©å®¹ã€‚

- å½“æ·»åŠ ç¬¬11ä¸ªå…ƒç´ æ—¶ï¼Œæ•°ç»„ä¼šæ‰©å®¹åˆ°åŸæ¥çš„1.5å€ã€‚åœ¨æ·»åŠ ç¬¬11ä¸ªå…ƒç´ ä¹‹å‰ï¼Œä¼šåˆ¤æ–­å‡ºæ·»åŠ ç¬¬11ä¸ªå…ƒç´ ä¼šå¯¼è‡´è¶…è¿‡æœ€å¤§å®¹é‡ï¼Œæ­¤æ—¶æ•°ç»„ä¼šè¿›è¡Œæ‰©å®¹ï¼Œæ‰©å®¹åˆ°åŸæœ‰å®¹é‡çš„1.5å€ï¼Œä¹Ÿå°±æ˜¯15ï¼Œä¹‹åæ‰§è¡Œæ·»åŠ æ“ä½œã€‚

æ‰©å®¹

```java
private void grow(int minCapacity)
            {
            // oldCapacityä¸ºæ—§å®¹é‡ï¼ŒnewCapacityä¸ºæ–°å®¹é‡
            int oldCapacity = elementData.length;
            int newCapacity = oldCapacity + (oldCapacity >> 1);
            // å°†oldCapacity å³ç§»ä¸€ä½ï¼Œå…¶æ•ˆæœç›¸å½“äºoldCapacity é™¤2
            // ä½è¿ç®—å¿«äºæ•´é™¤è¿ç®—
            if (newCapacity - minCapacity < 0)
                newCapacity = minCapacity;
            // æ£€æŸ¥æ‰©å®¹åå®¹é‡æ˜¯å¦æ»¡è¶³æœ€å°éœ€è¦å®¹é‡
            if (newCapacity - MAX_ARRAY_SIZE > 0)
                newCapacity = hugeCapacity(minCapacity);
            // æ£€æŸ¥æ‰©å®¹åå®¹é‡æ˜¯å¦å¤§äºè§„å®šçš„æ•°ç»„æœ€å¤§å®¹é‡
            // å¦‚æœè¶…è¿‡äº†ä½¿ç”¨hugeCapacity()æ–¹æ³•æ¯”è¾ƒminCapacityå’Œ MAX_ARRAY_SIZE
            // å¦‚æœminCapacityå¤§äºMAX_ARRAY_SIZEï¼Œåˆ™æ–°å®¹é‡åˆ™ä¸ºInteger.MAX_VALUE
            // å¦åˆ™ï¼Œæ–°å®¹é‡å¤§å°åˆ™ä¸º MAX_ARRAY_SIZEã€‚
            elementData = Arrays.copyOf(elementData, newCapacity);
        }
```
### `System.arraycopy()`å’Œ`Arrays.copyOf()`æ–¹æ³•

```
    /**
    *   å¤åˆ¶æ•°ç»„
    * @param src æºæ•°ç»„
    * @param srcPos æºæ•°ç»„ä¸­çš„èµ·å§‹ä½ç½®
    * @param dest ç›®æ ‡æ•°ç»„
    * @param destPos ç›®æ ‡æ•°ç»„ä¸­çš„èµ·å§‹ä½ç½®
    * @param length è¦å¤åˆ¶çš„æ•°ç»„å…ƒç´ çš„æ•°é‡
    */
    public static native void arraycopy(Object src,  int  srcPos,
                                        Object dest, int destPos,
                                        int length);

```
**åŒºåˆ«**ï¼š
`arraycopy()` éœ€è¦ç›®æ ‡æ•°ç»„ï¼Œå°†åŸæ•°ç»„æ‹·è´åˆ°ä½ è‡ªå·±å®šä¹‰çš„æ•°ç»„é‡Œæˆ–è€…åŸæ•°ç»„ï¼Œè€Œä¸”å¯ä»¥é€‰æ‹©æ‹·è´çš„èµ·ç‚¹å’Œé•¿åº¦ä»¥åŠæ”¾å…¥æ–°æ•°ç»„ä¸­çš„ä½ç½® `copyOf()` æ˜¯ç³»ç»Ÿè‡ªåŠ¨åœ¨å†…éƒ¨æ–°å»ºä¸€ä¸ªæ•°ç»„ï¼Œå¹¶è¿”å›è¯¥æ•°ç»„ã€‚
### æ–¹æ³•

- `add()`

    - ```java
        public boolean add(E e) {
                ensureCapacityInternal(size + 1);  // Increments modCount!!
                elementData[size++] = e;
                return true;
            }
        ```

    - 1. æ˜¯å¦æ‰©å®¹æ£€æŸ¥
        2. åˆ°æ•°ç»„æœ€åä¸€ä½æ’å…¥

- `add(int index, E e)`æ ¹æ®ç´¢å¼•æ’å…¥ï¼Œè¯¥æ–¹æ³•éœ€è¦å…ˆå¯¹å…ƒç´ è¿›è¡Œç§»åŠ¨

    - ```java
        public void add(int index, E element) {
                rangeCheckForAdd(index);
        
                ensureCapacityInternal(size + 1);  // Increments modCount!!
                System.arraycopy(elementData, index, elementData, index + 1,
                                 size - index);
                elementData[index] = element;
                size++;
            }
        ```

    - 1. æ£€æŸ¥ç´¢å¼•æ˜¯å¦è¶Šç•Œ
        2. æ˜¯å¦æ‰©å®¹æ£€æŸ¥
        3. ç§»åŠ¨ç´¢å¼•ä½ä¹‹åçš„å…ƒç´ ï¼Œç©ºå‡ºä¸€ä¸ªä½ç½®
        4. æ’å…¥

- `remove(int index)`åˆ é™¤æŒ‡å®šä½ç½®å…ƒç´ ï¼Œå°†åˆ é™¤ç‚¹ä¹‹åçš„å…ƒç´ å‘å‰ç§»åŠ¨ä¸€ä¸ªä½ç½®

    - ```java
        public E remove(int index) {
                rangeCheck(index);
        
                modCount++;
                E oldValue = elementData(index);
        
                int numMoved = size - index - 1;
                if (numMoved > 0)
                    System.arraycopy(elementData, index+1, elementData, index,
                                     numMoved);
                elementData[--size] = null; // clear to let GC do its work
        
                return oldValue;
            }
        ```

    - **æ³¨æ„ï¼š**ä¸ºäº†è®©GCèµ·ä½œç”¨ï¼Œå¿…é¡»æ˜¾å¼çš„ä¸ºæœ€åä¸€ä¸ªä½ç½®èµ‹`null`å€¼ã€‚

- `remove(Object o)`åˆ é™¤ç¬¬ä¸€ä¸ªä¸Object o equalsçš„å…ƒç´ 

    - ```java
        public boolean remove(Object o) {
                if (o == null) {
                    for (int index = 0; index < size; index++)
                        if (elementData[index] == null) {
                            fastRemove(index);
                            return true;
                        }
                } else {
                    for (int index = 0; index < size; index++)
                        if (o.equals(elementData[index])) {
                            fastRemove(index);
                            return true;
                        }
                }
                return false;
            }
        ```

- `trimToSize()`å°†åº•å±‚æ•°ç»„çš„å¤§å°è°ƒæ•´ä¸ºå½“å‰åˆ—è¡¨ä¿å­˜å…ƒç´ å®é™…å¤§å°
## Vector

## LinkedList
> `LinkedList`å®ç°äº†å¤šä¸ªæ¥å£ï¼ŒåŒæ—¶æ»¡è¶³é¡ºåºå®¹å™¨ï¼Œé˜Ÿåˆ—ï¼Œæ ˆçš„ç‰¹æ€§ã€‚

> æ•°æ®ç»“æ„ï¼šJDKåœ¨JDK1.6ä»¥å‰ä½¿ç”¨å¾ªç¯é“¾è¡¨ï¼ŒJDK1.7ä½¿ç”¨é“¾è¡¨

### æ–¹æ³•
- `add(int index, E element)`
    1. æ ¹æ®indexæ‰¾åˆ°è¦æ’å…¥çš„ä½ç½®
    2. ä¿®æ”¹å¼•ç”¨
    å› ä¸ºé“¾è¡¨æ˜¯åŒå‘çš„ï¼Œå§å¯ä»¥ä»å‰å¾€åæŸ¥æ‰¾ï¼Œä¹Ÿå¯ä»¥ä»åå¾€å‰æŸ¥æ‰¾ï¼Œæ‰€ä»¥ç¬¬ä¸€æ­¥æŸ¥æ‰¾ä½ç½®æ—¶ï¼Œä¼šå…ˆåˆ¤æ–­indexæ›´é è¿‘å‰ç«¯è¿˜æ˜¯åç«¯ã€‚
##  PriorityQueue

> ä¼˜å…ˆé˜Ÿåˆ—

1. ç›¸æ¯”äºQueueå¿…é¡»å…ˆè¿›å…ˆå‡ºï¼ŒPriorityQueueå¯ä»¥é€šè¿‡ä¿®æ”¹ä¼˜å…ˆçº§æ¥æŒ‡å®šå‡ºçš„é¡ºåº
2. æ”¾å…¥PriorityQueueçš„å…ƒç´ å¿…é¡»å®ç°Comparableæ¥å£
3. å¦‚æœéœ€è¦æ”¾å…¥çš„å…ƒç´ æ²¡æœ‰å®ç°Comparableæ¥å£ï¼Œåˆ™éœ€è¦åœ¨æ„é€ æ—¶ä¼ å…¥çš„æ¯”è¾ƒå™¨
4. ä¼˜å…ˆå–å‡ºæƒå€¼æœ€å°çš„å…ƒç´ 
4. éçº¿ç¨‹å®‰å…¨
4. ä½¿ç”¨äºŒå‰å †æ•°æ®ç»“æ„å®ç°ï¼Œåº•å±‚ä½¿ç”¨å¯å˜é•¿æ•°ç»„å­˜å‚¨æ•°æ®
4. é€šè¿‡å †å…ƒç´ çš„ä¸Šæµ®å’Œä¸‹æ²‰ï¼Œå®ç°åœ¨O(logn)æ—¶é—´å¤æ‚åº¦å†…æ’å…¥å…ƒç´ å’Œåˆ é™¤å †é¡¶å…ƒç´ 

## HashMap

> JDK8ä¸­HashMapåº•å±‚æ•°æ®ç»“æ„ï¼šæ•°ç»„+é“¾è¡¨+çº¢é»‘æ ‘ï¼ŒJDK8ä¹‹å‰ä¸ºï¼šæ•°ç»„+é“¾è¡¨
> JKD8ä¸­ï¼Œå½“é“¾è¡¨é•¿åº¦å¤§äºé˜ˆå€¼ï¼ˆé»˜è®¤ä¸º 8ï¼‰ï¼ˆå°†é“¾è¡¨è½¬æ¢æˆçº¢é»‘æ ‘å‰ä¼šåˆ¤æ–­ï¼Œå¦‚æœå½“å‰æ•°ç»„çš„é•¿åº¦å°äº 64ï¼Œé‚£ä¹ˆä¼šé€‰æ‹©å…ˆè¿›è¡Œæ•°ç»„æ‰©å®¹ï¼Œè€Œä¸æ˜¯è½¬æ¢ä¸ºçº¢é»‘æ ‘ï¼‰æ—¶ï¼Œå°†é“¾è¡¨è½¬åŒ–ä¸ºçº¢é»‘æ ‘ï¼Œä»¥å‡å°‘æœç´¢æ—¶é—´ã€‚

> å³ï¼šå¦‚æœé“¾è¡¨é•¿åº¦ > 8 && æ•°ç»„é•¿åº¦ < 64 æ‰å°†é“¾è¡¨è½¬æ¢ä¸ºçº¢é»‘æ ‘
å¦‚æœæ•°ç»„é•¿åº¦ < 64åˆ™ä¼šå…ˆæ‰©å®¹æ•°ç»„ã€‚å¦‚æœçº¢é»‘æ ‘ä¸­å…ƒç´ ä¸ªæ•° < 6ï¼Œå°†çº¢é»‘æ ‘è½¬æ¢å›é“¾è¡¨ã€‚æ¯ä¸ªæ•°ç»„ä¸€ä¸ªå…ƒç´ å¯¹åº”ä¸€ä¸ªé“¾è¡¨ã€‚

![image-20220909134246601](https://typora-1308549476.cos.ap-nanjing.myqcloud.com/img/image-20220909134246601.png)

### HashMap.put()

>HashMap é€šè¿‡ key çš„ `hashcode` ç»è¿‡æ‰°åŠ¨å‡½æ•°å¤„ç†è¿‡åå¾—åˆ° hash å€¼ï¼Œç„¶åé€šè¿‡ `(n - 1) & hash` åˆ¤æ–­å½“å‰å…ƒç´ å­˜æ”¾çš„ä½ç½®ï¼ˆè¿™é‡Œçš„ n æŒ‡çš„æ˜¯æ•°ç»„çš„é•¿åº¦ï¼‰ï¼Œå¦‚æœå½“å‰ä½ç½®å­˜åœ¨å…ƒç´ çš„è¯ï¼Œå°±åˆ¤æ–­è¯¥å…ƒç´ ä¸è¦å­˜å…¥çš„å…ƒç´ çš„ hash å€¼ä»¥åŠ key æ˜¯å¦ç›¸åŒï¼Œå¦‚æœç›¸åŒçš„è¯ï¼Œç›´æ¥è¦†ç›–ï¼Œä¸ç›¸åŒå°±é€šè¿‡æ‹‰é“¾æ³•è§£å†³å†²çªã€‚

> å¦‚æœHashå†²çªï¼Œæ’å…¥ä¹‹å‰ä¼šåˆ¤æ–­è¯¥èŠ‚ç‚¹ç±»å‹æ˜¯TreeNodeè¿˜æ˜¯Nodeï¼Œå¦‚æœæ˜¯TreeNodeåˆ™æŒ‰ç…§çº¢é»‘æ ‘çš„æ–¹æ³•æ’å…¥å…ƒç´ ï¼Œå¦‚æœæ˜¯Nodeï¼Œåœ¨JDK1.7ä¸­ä½¿ç”¨å¤´æ’æ³•ï¼ŒJDK1.8ä¸­ä½¿ç”¨å°¾æ’æ³•ã€‚

> **å¤´æ’æ³•å’Œå°¾æ’æ³•**ï¼šä¸€ä¸ªæ˜¯åœ¨é“¾è¡¨å¤´éƒ¨æ’å…¥å…ƒç´ ï¼Œä¸€ä¸ªæ˜¯å’‹é“¾è¡¨å°¾éƒ¨æ’å…¥å…ƒç´ ã€‚å¤´æ’æ³•ä¼šæ”¹å˜é“¾è¡¨çš„é¡ºåºï¼Œåœ¨å¹¶å‘æ—¶ï¼Œå¯èƒ½ä¼šå‡ºç°é“¾è¡¨æˆç¯çš„é—®é¢˜ã€‚å°¾æ’æ³•ä¸ä¼šæ”¹å˜é“¾è¡¨åŸæ¥çš„é¡ºåºï¼Œä¸ä¼šå‡ºç°æˆç¯çš„é—®é¢˜ã€‚

>**"æ‰°åŠ¨å‡½æ•°"**ï¼š HashMap çš„ `hash` æ–¹æ³•ã€‚ä½¿ç”¨ `hash` æ–¹æ³•ä¹Ÿå°±æ˜¯æ‰°åŠ¨å‡½æ•°æ˜¯ä¸ºäº†é˜²æ­¢ä¸€äº›å®ç°æ¯”è¾ƒå·®çš„ `hashCode()` æ–¹æ³• æ¢å¥è¯è¯´ä½¿ç”¨æ‰°åŠ¨å‡½æ•°ä¹‹åå¯ä»¥å‡å°‘ç¢°æ’ã€‚

>**â€œæ‹‰é“¾æ³•â€** ï¼šå°†é“¾è¡¨å’Œæ•°ç»„ç›¸ç»“åˆã€‚ä¹Ÿå°±æ˜¯è¯´åˆ›å»ºä¸€ä¸ªé“¾è¡¨æ•°ç»„ï¼Œæ•°ç»„ä¸­æ¯ä¸€æ ¼å°±æ˜¯ä¸€ä¸ªé“¾è¡¨ã€‚è‹¥é‡åˆ°å“ˆå¸Œå†²çªï¼Œåˆ™å°†å†²çªçš„å€¼åŠ åˆ°é“¾è¡¨ä¸­å³å¯ã€‚

```java
public V put(K key, V value) {
        return putVal(hash(key), key, value, false, true);
    }

    /**
     * Implements Map.put and related methods.
     *
     * @param hash keyçš„hashå€¼
     * @param key the key
     * @param value the value to put
     * @param onlyIfAbsent å¦‚æœä¸ºçœŸï¼Œåªæœ‰åœ¨ä¸å­˜åœ¨keyæ—¶æ‰ä¼šput
     * @param evict if false, the table is in creation mode.
     * @return previous value, or null if none
     */
    final V putVal(int hash, K key, V value, boolean onlyIfAbsent,
                   boolean evict) {
        Node<K,V>[] tab; Node<K,V> p; int n, i;
        //ç¬¬ä¸€æ¬¡putä¼šä½¿ç”¨resizeæ–¹æ³•æ£€æŸ¥æ˜¯å¦éœ€è¦æ‰©å®¹
        if ((tab = table) == null || (n = tab.length) == 0)
            n = (tab = resize()).length;
        //ç»™èŠ‚ç‚¹èµ‹å€¼
        //å¦‚æœæ²¡æœ‰èŠ‚ç‚¹ï¼Œå°±åˆ›å»ºä¸€ä¸ªæ–°çš„èŠ‚ç‚¹
        if ((p = tab[i = (n - 1) & hash]) == null)
            tab[i] = newNode(hash, key, value, null);
        //eleså¦‚æœè¿™ä¸ªèŠ‚ç‚¹å·²ç»æœ‰æ•°æ®äº†
        else {
            Node<K,V> e; K k;
            // é¦–å…ˆï¼Œåˆ¤æ–­è¯¥ä½ç½®çš„ç¬¬ä¸€ä¸ªæ•°æ®å’Œæˆ‘ä»¬è¦æ’å…¥çš„æ•°æ®ï¼Œkey æ˜¯ä¸æ˜¯"ç›¸ç­‰"
            if (p.hash == hash &&
                ((k = p.key) == key || (key != null && key.equals(k))))
                //å¦‚æœæ˜¯ï¼Œå–å‡ºè¿™ä¸ªèŠ‚ç‚¹
                e = p;
            // å¦‚æœè¯¥èŠ‚ç‚¹æ˜¯ä»£è¡¨çº¢é»‘æ ‘çš„èŠ‚ç‚¹ï¼Œè°ƒç”¨çº¢é»‘æ ‘çš„æ’å€¼æ–¹æ³•
            else if (p instanceof TreeNode)
                e = ((TreeNode<K,V>)p).putTreeVal(this, tab, hash, key, value);
            //elseæ•°ç»„è¯¥ä½ç½®ä¸æ˜¯çº¢é»‘æ ‘èŠ‚ç‚¹ï¼Œè€Œæ˜¯é“¾è¡¨
            else {
                for (int binCount = 0; ; ++binCount) {
                    //æ’å…¥åˆ°é“¾è¡¨åé¢
                    if ((e = p.next) == null) {
                        p.next = newNode(hash, key, value, null);
                        //TREEIFY_THRESHOLD = 8
                        //å¦‚æœæ–°æ’å…¥çš„å€¼æ—¶é“¾è¡¨ä¸­çš„ç¬¬8ä¸ª
                        if (binCount >= TREEIFY_THRESHOLD - 1) // -1 for 1st
                            //treeifyBin()æ–¹æ³•ä¼šå°†é“¾è¡¨è½¬åŒ–ä¸ºçº¢é»‘æ ‘
                            treeifyBin(tab, hash);
                        break;
                    }
                    //å¦‚æœåœ¨é“¾è¡¨ä¸­æ‰¾åˆ°äº†ç›¸ç­‰çš„key
                    if (e.hash == hash &&
                        ((k = e.key) == key || (key != null && key.equals(k))))
                        //break æ­¤æ—¶eä¸ºé“¾è¡¨ä¸­ä¸è¦æ’å…¥æ–°å€¼çš„keyç›¸ç­‰çš„node
                        break;
                    p = e;
                }
            }
            //e != null è¯´æ˜æ—§å€¼çš„keyä¸æ’å…¥çš„keyç›¸ç­‰
            //å€¼è¦†ç›–ï¼Œè¿”å›æ—§å€¼
            if (e != null) { // existing mapping for key
                V oldValue = e.value;
                if (!onlyIfAbsent || oldValue == null)
                    e.value = value;
                afterNodeAccess(e);
                return oldValue;
            }
        }
        ++modCount;
        //å¦‚æœæ’å…¥åsizeè¶…è¿‡é˜ˆå€¼ï¼Œå°±å¯¹å…¶æ‰©å®¹
        //ä»æ•´ä¸ªæ–¹æ³•æ¥çœ‹ï¼Œå…ˆæ’å…¥å†è€ƒè™‘æ‰©å®¹
        if (++size > threshold)
            resize();
        afterNodeInsertion(evict);
        return null;
    }
```

### HashMapæ‰©å®¹

> æ¯æ¬¡æ‰©å®¹ä¸ºåŸæ¥çš„2å€
>
> resize()åŒæ—¶ä¹Ÿç”¨æ¥åˆå§‹åŒ–å®¹é‡

```java
	/**
     * Initializes or doubles table size.  If null, allocates in
     * accord with initial capacity target held in field threshold.
     * Otherwise, because we are using power-of-two expansion, the
     * elements from each bin must either stay at same index, or move
     * with a power of two offset in the new table.
     *
     * @return the table
     */
    final Node<K,V>[] resize() {
        Node<K,V>[] oldTab = table;
        int oldCap = (oldTab == null) ? 0 : oldTab.length;
        int oldThr = threshold;
        int newCap, newThr = 0;
        //æ‰©å®¹
        if (oldCap > 0) {
            if (oldCap >= MAXIMUM_CAPACITY) {
                threshold = Integer.MAX_VALUE;
                return oldTab;
            }
            //æ•°ç»„æ‰©å¤§ä¸€å€
            else if ((newCap = oldCap << 1) < MAXIMUM_CAPACITY &&
                     oldCap >= DEFAULT_INITIAL_CAPACITY)
                //é˜ˆå€¼æ‰©å¤§ä¸€å€
                newThr = oldThr << 1; // double threshold
        }
        else if (oldThr > 0) // initial capacity was placed in threshold
            newCap = oldThr;
        else {               // zero initial threshold signifies using defaults
            newCap = DEFAULT_INITIAL_CAPACITY;
            newThr = (int)(DEFAULT_LOAD_FACTOR * DEFAULT_INITIAL_CAPACITY);
        }
        if (newThr == 0) {
            float ft = (float)newCap * loadFactor;
            newThr = (newCap < MAXIMUM_CAPACITY && ft < (float)MAXIMUM_CAPACITY ?
                      (int)ft : Integer.MAX_VALUE);
        }
        threshold = newThr;
        @SuppressWarnings({"rawtypes","unchecked"})
        //ç”¨æ–°çš„æ•°ç»„å¤§å°åˆå§‹åŒ–æ–°çš„æ•°ç»„
        Node<K,V>[] newTab = (Node<K,V>[])new Node[newCap];
        //åˆå§‹åŒ–æ•°ç»„ç»“æŸ
        table = newTab;
        
        //æ•°æ®è¿ç§»
        if (oldTab != null) {
            for (int j = 0; j < oldCap; ++j) {
                Node<K,V> e;
                if ((e = oldTab[j]) != null) {
                    oldTab[j] = null;
                    if (e.next == null)
                        newTab[e.hash & (newCap - 1)] = e;
                    else if (e instanceof TreeNode)
                        ((TreeNode<K,V>)e).split(this, newTab, j, oldCap);
                    else { // preserve order
                        Node<K,V> loHead = null, loTail = null;
                        Node<K,V> hiHead = null, hiTail = null;
                        Node<K,V> next;
                        do {
                            next = e.next;
                            if ((e.hash & oldCap) == 0) {
                                if (loTail == null)
                                    loHead = e;
                                else
                                    loTail.next = e;
                                loTail = e;
                            }
                            else {
                                if (hiTail == null)
                                    hiHead = e;
                                else
                                    hiTail.next = e;
                                hiTail = e;
                            }
                        } while ((e = next) != null);
                        if (loTail != null) {
                            loTail.next = null;
                            newTab[j] = loHead;
                        }
                        if (hiTail != null) {
                            hiTail.next = null;
                            newTab[j + oldCap] = hiHead;
                        }
                    }
                }
            }
        }
        return newTab;
    }
```

```java
 /**
     * Returns a power of two size for the given target capacity.
     */
    static final int tableSizeFor(int cap) {
        int n = cap - 1;
        n |= n >>> 1;
        n |= n >>> 2;
        n |= n >>> 4;
        n |= n >>> 8;
        n |= n >>> 16;
        return (n < 0) ? 1 : (n >= MAXIMUM_CAPACITY) ? MAXIMUM_CAPACITY : n + 1;
    }
```

> Q11ï¼šä¸ºä»€ä¹ˆHashMapçš„é•¿åº¦æ˜¯2çš„å¹‚æ¬¡æ–¹
>
> HashMapä¸­æ•°ç»„ä¸‹æ ‡çš„è®¡ç®—æ–¹å¼æ˜¯ `(n - 1) & hash`ï¼Œä¸ºä»€ä¹ˆæ˜¯&è€Œä¸æ˜¯%å‘¢
>
> **â€œå–ä½™(%)æ“ä½œä¸­å¦‚æœé™¤æ•°æ˜¯ 2 çš„å¹‚æ¬¡åˆ™ç­‰ä»·äºä¸å…¶é™¤æ•°å‡ä¸€çš„ä¸(&)æ“ä½œï¼ˆä¹Ÿå°±æ˜¯è¯´ hash%length == hash&(length-1)çš„å‰ææ˜¯ length æ˜¯ 2 çš„ n æ¬¡æ–¹ï¼›ï¼‰ã€‚â€** å¹¶ä¸” **é‡‡ç”¨äºŒè¿›åˆ¶ä½æ“ä½œ &ï¼Œç›¸å¯¹äº%èƒ½å¤Ÿæé«˜è¿ç®—æ•ˆç‡ï¼Œè¿™å°±è§£é‡Šäº† HashMap çš„é•¿åº¦ä¸ºä»€ä¹ˆæ˜¯ 2 çš„å¹‚æ¬¡æ–¹ã€‚**

### HashMap.get()

1. è®¡ç®—keyçš„hashå€¼ï¼Œæ ¹æ®hashå€¼æ‰¾åˆ°å¯¹åº”æ•°ç»„ä¸‹æ ‡
2. åˆ¤æ–­æ•°ç»„è¯¥ä½ç½®çš„å…ƒç´ æ˜¯å¦æ—¶éœ€è¦çš„value
3. å¦‚æœä¸æ˜¯ï¼Œåˆ¤æ–­è¯¥å…ƒç´ ç±»å‹æ˜¯å¦æ—¶`TreeNode`ï¼Œå¦‚æœæ˜¯ï¼Œç”¨çº¢é»‘æ ‘çš„æ–¹æ³•å–æ•°æ®
4. å¦‚æœä¸æ˜¯ï¼Œéå†é“¾è¡¨ï¼Œç›´åˆ°æ‰¾åˆ°(== || equals)çš„key

```java
public V get(Object key) {
        Node<K,V> e;
        return (e = getNode(hash(key), key)) == null ? null : e.value;
    }

    /**
     * Implements Map.get and related methods.
     *
     * @param hash hash for key
     * @param key the key
     * @return the node, or null if none
     */
    final Node<K,V> getNode(int hash, Object key) {
        Node<K,V>[] tab; Node<K,V> first, e; int n; K k;
        if ((tab = table) != null && (n = tab.length) > 0 &&
            (first = tab[(n - 1) & hash]) != null) {
            //åˆ¤æ–­ç¬¬ä¸€ä¸ªèŠ‚ç‚¹æ˜¯ä¸æ˜¯è¦æ‰¾çš„
            if (first.hash == hash && // always check first node
                ((k = first.key) == key || (key != null && key.equals(k))))
                return first;
            if ((e = first.next) != null) {
                //åˆ¤æ–­æ˜¯å¦ä¸ºçº¢é»‘æ ‘
                if (first instanceof TreeNode)
                    return ((TreeNode<K,V>)first).getTreeNode(hash, key);
                do {
                    //éå†é“¾è¡¨
                    if (e.hash == hash &&
                        ((k = e.key) == key || (key != null && key.equals(k))))
                        return e;
                } while ((e = e.next) != null);
            }
        }
        return null;
    }
```

> Q12ï¼šHashMapçš„7ç§éå†æ–¹å¼
>
> [åŸæ–‡è¿æ¥](https://mp.weixin.qq.com/s/zQBN3UvJDhRTKP6SzcZFKw)
>
> 1. ä½¿ç”¨è¿­ä»£å™¨ï¼ˆIteratorï¼‰EntrySet çš„æ–¹å¼è¿›è¡Œéå†ï¼›
> 2. ä½¿ç”¨è¿­ä»£å™¨ï¼ˆIteratorï¼‰KeySet çš„æ–¹å¼è¿›è¡Œéå†ï¼›
> 3. ä½¿ç”¨ For Each EntrySet çš„æ–¹å¼è¿›è¡Œéå†ï¼›
> 4. ä½¿ç”¨ For Each KeySet çš„æ–¹å¼è¿›è¡Œéå†ï¼›
> 5. ä½¿ç”¨ Lambda è¡¨è¾¾å¼çš„æ–¹å¼è¿›è¡Œéå†ï¼›
> 6. ä½¿ç”¨ Streams API å•çº¿ç¨‹çš„æ–¹å¼è¿›è¡Œéå†ï¼›
> 7. ä½¿ç”¨ Streams API å¤šçº¿ç¨‹çš„æ–¹å¼è¿›è¡Œéå†ã€‚
>
> ç»“è®ºï¼šæ€§èƒ½æœ€å¥½çš„æ˜¯`entrySet`æœ€å·®çš„æ˜¯`keyset`

## HashSet

> HashSetåŸºäºHashMapå®ç°
>
> **åŒºåˆ«**ï¼š`HashSet`ä½¿ç”¨æˆå‘˜å¯¹è±¡è®¡ç®—hashcodeå€¼ï¼Œhashcodeæœ‰å¯èƒ½é‡å¤ï¼Œå½“hashcodeé‡å¤æ—¶è¿˜éœ€è¦equalsåˆ¤æ–­æ˜¯å¦ç›¸ç­‰
>
> HashMaoä½¿ç”¨keyè®¡ç®—hashcode

> Q9ï¼šHashMap å’Œ TreeMap åŒºåˆ«
>
> - ä¸¤è€…éƒ½ç»§æ‰¿`AbstractMap`,ä½†æ˜¯TreeMapé¢å¤–å®ç°äº†`NavigableMao`å’Œ`SOrtedMap`ä½¿TreeMapä½•ä»¥æŸ¥è¯¢å’Œæ’åº
> - TreeMapæ’åºé»˜è®¤æŒ‰ç…§keyå‡åºæ’åˆ—

> Q10ï¼šHashSetå¦‚ä½•æ£€æŸ¥æ˜¯å¦é‡å¤
>
> å½“ä½ æŠŠå¯¹è±¡åŠ å…¥`HashSet`æ—¶ï¼Œ`HashSet` ä¼šå…ˆè®¡ç®—å¯¹è±¡çš„`hashcode`å€¼æ¥åˆ¤æ–­å¯¹è±¡åŠ å…¥çš„ä½ç½®ï¼ŒåŒæ—¶ä¹Ÿä¼šä¸å…¶ä»–åŠ å…¥çš„å¯¹è±¡çš„ `hashcode` å€¼ä½œæ¯”è¾ƒï¼Œå¦‚æœæ²¡æœ‰ç›¸ç¬¦çš„ `hashcode`ï¼Œ`HashSet` ä¼šå‡è®¾å¯¹è±¡æ²¡æœ‰é‡å¤å‡ºç°ã€‚ä½†æ˜¯å¦‚æœå‘ç°æœ‰ç›¸åŒ `hashcode` å€¼çš„å¯¹è±¡ï¼Œè¿™æ—¶ä¼šè°ƒç”¨`equals()`æ–¹æ³•æ¥æ£€æŸ¥ `hashcode` ç›¸ç­‰çš„å¯¹è±¡æ˜¯å¦çœŸçš„ç›¸åŒã€‚å¦‚æœä¸¤è€…ç›¸åŒï¼Œ`HashSet` å°±ä¸ä¼šè®©åŠ å…¥æ“ä½œæˆåŠŸã€‚

## ConcurrentHashTable

> å¹¶å‘HashMap(ConcurrentHashMap)

> Q11ï¼šConcurrentHashMapå’ŒHashMapçš„åŒºåˆ«ï¼š
>
> - **åº•å±‚æ•°æ®ç»“æ„**ï¼šJDK7ä¸­`ConcurrentHashMap`åº•å±‚é‡‡ç”¨**åˆ†æ®µçš„æ•°ç»„+é“¾è¡¨**ï¼ŒJDK8ç§ä½¿ç”¨**æ•°ç»„+é“¾è¡¨+çº¢é»‘æ ‘**å®ç°ã€‚`HashTable`ä½¿ç”¨æ•°ç»„+é“¾è¡¨ï¼Œæ•°ç»„æ˜¯ HashMap çš„ä¸»ä½“ï¼Œé“¾è¡¨åˆ™æ˜¯ä¸»è¦ä¸ºäº†è§£å†³å“ˆå¸Œå†²çªè€Œå­˜åœ¨çš„ã€‚
> - **å®ç°çº¿ç¨‹å®‰å…¨çš„æ–¹å¼**ï¼šJDK8ä¸­ï¼Œ`ConcurrentHashMap`å¹¶å‘æ§åˆ¶ä½¿ç”¨`Synchorized`å’ŒCASæ“ä½œã€‚ä¹Ÿä½¿ç”¨ `synchronized` æ¥ä¿è¯çº¿ç¨‹å®‰å…¨ï¼Œä½†æ˜¯æ•ˆç‡éå¸¸ä½ä¸‹ã€‚å½“ä¸€ä¸ªçº¿ç¨‹è®¿é—®åŒæ­¥æ–¹æ³•æ—¶ï¼Œå…¶ä»–çº¿ç¨‹ä¹Ÿè®¿é—®åŒæ­¥æ–¹æ³•ï¼Œå¯èƒ½ä¼šè¿›å…¥é˜»å¡æˆ–è½®è¯¢çŠ¶æ€ï¼Œå¦‚ä½¿ç”¨ put æ·»åŠ å…ƒç´ ï¼Œå¦ä¸€ä¸ªçº¿ç¨‹ä¸èƒ½ä½¿ç”¨ put æ·»åŠ å…ƒç´ ï¼Œä¹Ÿä¸èƒ½ä½¿ç”¨ getï¼Œç«äº‰ä¼šè¶Šæ¥è¶Šæ¿€çƒˆæ•ˆç‡è¶Šä½ã€‚

HashTableçš„æ•°æ®ç»“æ„

![image-20220909164559669](https://typora-1308549476.cos.ap-nanjing.myqcloud.com/img/image-20220909164559669.png)

ConcurrentHashTableçš„æ•°æ®ç»“æ„

![image-20220909164639598](https://typora-1308549476.cos.ap-nanjing.myqcloud.com/img/image-20220909164639598.png)

> Q12ï¼šJDK 1.7 å’Œ JDK 1.8 çš„ ConcurrentHashMap å®ç°æœ‰ä»€ä¹ˆä¸åŒï¼Ÿ
>
> 1. çº¿ç¨‹å®‰å…¨å®ç°æ–¹å¼ä¸åŒï¼š
>     - JDK7ä½¿ç”¨Segmentåˆ†æ®µé”ä¿è¯å®‰å…¨ã€‚
>     - JDK8ä½¿ç”¨Node + CAS + synchorizedä¿è¯å®‰å…¨ï¼Œsynchorizedåªé”å®šå½“å‰é“¾è¡¨æˆ–çº¢é»‘æ ‘çš„é¦–èŠ‚ç‚¹
> 2. è§£å†³Hashç¢°æ’çš„æ–¹æ³•ä¸åŒï¼š
>     - JDK7ä½¿ç”¨æ‹‰é“¾æ³•
>     - JDK8ä½¿ç”¨æ‹‰é“¾æ³•ç»“åˆçº¢é»‘æ ‘ï¼ˆæ€ä¹ˆç»“åˆï¼Ÿé“¾è¡¨é•¿åº¦è¶…è¿‡8ä¹‹åï¼Œå°†é“¾è¡¨è½¬æ¢ä¸ºçº¢é»‘æ ‘ï¼‰
> 3. å¹¶å‘åº¦ä¸åŒï¼š
>     - JDK7ä¸­æœ€å¤§å¹¶å‘æ•°æ˜¯Segmentä¸ªæ•°ï¼Œé»˜è®¤16ã€‚
>     - JDK8ä¸­æœ€å¤§å¹¶å‘åº¦æ˜¯Nodeæ•°ç»„çš„å¤§å°ï¼Œå¹¶å‘é‡æ›´å¤§

## TreeMapå’ŒTreeSet

> TreeMapå®ç°äº†SortedMapæ¥å£ï¼Œå¯ä»¥æŒ‰ç…§keyçš„è‡ªç„¶é¡ºåºï¼ˆnatural orderingï¼‰æ’åºæˆ–è€…æ‰‹åŠ¨ä¼ å…¥æ¯”è¾ƒå™¨ï¼ˆComparatorï¼‰
>
> TreeMapåº•å±‚é€šè¿‡çº¢é»‘æ ‘å®ç°ï¼ŒæŸ¥æ‰¾ï¼Œæ·»åŠ ï¼Œåˆ é™¤ï¼Œæ—¶é—´å¤æ‚åº¦å‡ä¸ºlog(n)
>
> TreeMapæ˜¯éåŒæ­¥çš„ï¼Œçº¿ç¨‹ä¸å®‰å…¨

## WeekHashMap


